{% extends 'base.html' %}

{% block head_title %}Leave a Review{% endblock %}

{% block content %}
  <div class="catalog-shell">
    <h1 class="catalog-title">Leave a Review</h1>
    <p>Share your experience with a hospital or healthcare facility.</p>

    <!-- Flash messages for feedback -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="flash-message {{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <!-- Review Form -->
    <div class="review-form-container">
      <form method="POST" action="{{ url_for('review') }}" class="review-form">
        {{ form.hidden_tag() }}
        
        <div class="form-group">
          <label for="hospital_name">Hospital Name</label>
          {{ form.hospital_name(class="form-input") }}
        </div>

        <div class="form-group">
          <label for="rating">Rating (1-5 stars)</label>
          {{ form.rating(class="form-input", type="number", min="1", max="5") }}
          <small>Please rate from 1 (poor) to 5 (excellent)</small>
        </div>

        <div class="form-group">
          <label for="comment">Your Review</label>
          {{ form.comment(class="form-textarea", rows="5") }}
          <small>Minimum 10 characters, maximum 500 characters</small>
        </div>

        <button type="submit" class="btn-primary">Submit Review</button>
      </form>
    </div>

    <!-- Previous Reviews Section -->
    {% if user_reviews %}
    <div class="previous-reviews">
      <h2>Your Recent Reviews</h2>
      {% for review in user_reviews %}
      <div class="review-card">
        <div class="review-header">
          <strong>{{ review.hospital_name }}</strong>
          <span class="review-rating">{{ '‚≠ê' * review.rating }}</span>
        </div>
        <p class="review-comment">{{ review.comment }}</p>
        <small class="review-date">{{ review.created_at }}</small>
      </div>
      {% endfor %}
    </div>
    {% endif %}
  </div>
{% endblock %}
